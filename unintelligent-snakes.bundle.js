!function(e){function t(t){for(var a,o,r=t[0],h=t[1],d=t[2],l=0,p=[];l<r.length;l++)o=r[l],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(a in h)Object.prototype.hasOwnProperty.call(h,a)&&(e[a]=h[a]);for(c&&c(t);p.length;)p.shift()();return s.push.apply(s,d||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],a=!0,r=1;r<n.length;r++){var h=n[r];0!==i[h]&&(a=!1)}a&&(s.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},i={4:0},s=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var r=window.webpackJsonp=window.webpackJsonp||[],h=r.push.bind(r);r.push=t,r=r.slice();for(var d=0;d<r.length;d++)t(r[d]);var c=h;s.push([264,0]),n()}({264:function(e,t,n){"use strict";n.r(t);var a=n(46),i=n(94);class s{constructor(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1;this._moves=[[-1,-1],[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0]],this.ACTION_SPACE_SIZE=4,this.OBSERVATION_SPACE_VALUES=24,this.map_width=e,this.map_height=t,this.map=[];for(var s=0;s<e;s++){this.map.push([]);for(var o=0;o<t;o++)this.map[this.map.length-1].push(0)}this._DEAD_REWARD=i,this._FOOD_REWARD=n,this._BASE_REWARD=a,this.reset()}clone(){for(var e=new s(this.map_width,this.map_height,this._FOOD_REWARD,this._BASE_REWARD,this._DEAD_REWARD),t=0;t<this.map_width;t++)for(var n=0;n<this.map_height;n++)e.map[t][n]=this.map[t][n];e.head_x=this.head_x,e.head_y=this.head_y,e.body=[];for(var a=0;a<this.body.length;a++)e.body.push([this.body[a][0],this.body[a][1]]);return e}_getFreePos(){for(var e=Object(a.b)(0,this.map_width),t=Object(a.b)(0,this.map_height),n=e,i=t;0!=this.map[e][t];)if((e+=1)==this.map_width&&(e=0,(t+=1)==this.map_height&&(t=0)),e==n&&t==i)throw new Exception("no free space");return[e,t]}_generateFood(){var e=this._getFreePos();this.food_x=e[0],this.food_y=e[1],this.map[this.food_x][this.food_y]=2}_getObservation(){for(var e=[],t=0;t<24;t++)e.push(0);var n=this.map_width-this.head_x-1,a=this.map_height-this.head_y-1;e[0]=Math.min(this.head_x,this.head_y)+1,e[1]=this.head_y+1,e[2]=Math.min(n,this.head_y)+1,e[3]=n+1,e[4]=Math.min(n,a)+1,e[5]=a+1,e[6]=Math.min(this.head_x,a)+1,e[7]=this.head_x+1;for(var i=0;i<8;i++)for(var s=this.head_x+this._moves[i][0],o=this.head_y+this._moves[i][1],r=!1,h=!1,d=1;s>=0&&s<this.map_width&&o>=0&&o<this.map_height&&(!r||!h);)h||1!=this.map[s][o]?r||2!=this.map[s][o]||(e[16+i]=d,r=!0):(e[8+i]=d,h=!0),d+=1,s+=this._moves[i][0],o+=this._moves[i][1];return e}step(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._lastAction=e,t=0==e?this._move(0,-1):1==e?this._move(1,0):2==e?this._move(0,1):this._move(-1,0),{observation:n?this._getObservation():null,reward:t,done:t==this._DEAD_REWARD||this.body.length+1>=this.map_width*this.map_height}}_move(e,t){return this.head_x+e<0||this.head_x+e>=this.map_width||this.head_y+t<0||this.head_y+t>=this.map_height||1==this.map[this.head_x+e][this.head_y+t]?this._DEAD_REWARD:2==this.map[this.head_x+e][this.head_y+t]?(this._moveto(this.head_x+e,this.head_y+t,!1),this.body.length+1<this.map_width*this.map_height&&this._generateFood(),this._FOOD_REWARD):(this._moveto(this.head_x+e,this.head_y+t),this._BASE_REWARD)}_moveto(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.head_x=e,this.head_y=t,this.body.unshift([e,t]),this.map[e][t]=1,n){var a=this.body.pop(),i=a[0],s=a[1];this.map[i][s]=0}}reset(){for(var e=0;e<this.map_width;e++)for(var t=0;t<this.map_height;t++)this.map[e][t]=0;return this.head_x=Math.floor(this.map_width/2),this.head_y=Math.floor(this.map_height/2),this._lastAction=-10,this.body=[],this.body.push([this.head_x,this.head_y]),this.map[this.head_x][this.head_y]=1,this._generateFood(),this._getObservation()}getSuccessors(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t={},n=0;n<4;n++)if(2!=Math.abs(n-this._lastAction)){t[n]={env:this.clone()};var a=t[n].env.step(n,e);a.done?delete t[n]:(e&&(t[n].obs=a.observation),t[n].reward=a.reward,t[n].done=a.done)}return t}}var o=document.getElementById("snake-container"),r=document.getElementById("snake-game");class h{constructor(e,t,n){this.env=new s(e,t),this.blockSize=400/e,this.pad=.2*this.blockSize,this.w=e,this.h=t,this.processObservation=n,this.app=new i.Application({width:400,height:400,backgroundColor:0}),this.g=new i.Graphics,this.app.stage.addChild(this.g),r.insertBefore(this.app.view,r.children[0]),this.updateCanvas(),this.currentAction=null,this.waitingToExecuteAction=!0,this.processObservation(this,this.env._getObservation()),this.app.ticker.maxFPS=1,this.app.ticker.add((e=>{if(!this.waitingToExecuteAction){var t=this.env.step(this.currentAction);this.waitingToExecuteAction=!0,t.done?this.reset():this.processObservation(this,t),this.updateCanvas()}}))}sendAction(e){this.currentAction=e,this.waitingToExecuteAction=!1}updateCanvas(){var e=this.blockSize/2;this.g.clear(),this.g.moveTo(0,0),this.g.lineStyle(0),this.g.beginFill(6750054,1),this.g.drawCircle(this.env.food_x*this.blockSize+e,this.env.food_y*this.blockSize+e,.3*this.blockSize);var t=.1;this.g.beginFill(16777215),this.g.drawRect((this.env.head_x+t)*this.blockSize,(this.env.head_y+t)*this.blockSize,.8*this.blockSize,.8*this.blockSize),this.g.lineStyle(.5*this.blockSize,16777215),this.g.beginFill(0,0),this.g.moveTo(this.env.body[0][0]*this.blockSize+e,this.env.body[0][1]*this.blockSize+e);for(var n=1;n<this.env.body.length;n++)this.g.lineTo(this.env.body[n][0]*this.blockSize+e,this.env.body[n][1]*this.blockSize+e)}reset(){this.processObservation(this,{observation:this.env.reset(),reward:0,done:!1,reset:!0}),this.updateCanvas()}setFPS(e){this.app.ticker.maxFPS=e}}var d=null,c=0,l=[],p=[],f=null;function m(e){d.processObservation=l[e].processObservation,p[c].className="snake-selection",p[c=e].className="snake-selection selected",f.innerHTML=l[e].description}Object(a.a)();var v=null,u=[];function b(e,t){if(0!=t){e.expanded=!0;for(var n=e.env.getSuccessors(),a=0;a<4;a++)if(n[a]){var i=a;e[a]={env:n[a].env,safeFood:1==n[a].reward,parent:e,action:i,expanded:!1},b(e[a],t-1)}}}function g(e){if(!e.expanded)return 1;for(var t=0,n=0;n<4;n++)e[n]&&(t+=g(e[n]));return t}function _(e,t){if(0!=t)if(e.expanded)for(var n=0;n<4;n++)e[n]&&_(e[n],t-1);else b(e,t)}function y(e,t){if(e.expanded||b(e,t),0==t){if(!e.expanded)return!0;for(var n=0;n<4;n++)if(e[n])return!0}for(n=0;n<4;n++)if(e[n]&&y(e[n],t-1))return!0;return!1}var w=0;!function(e,t,n){d=new h(e,t,n[0].processObservation),l=n;var a=document.createElement("div");a.className="fc snake-info-section";for(var i=document.createElement("div"),s=function(){var e=r;(c=document.createElement("div")).className="snake-selection",c.textContent=n[r].name,c.addEventListener("click",(function(){m(e)})),p.push(c),i.appendChild(c)},r=0;r<n.length;r++){var c;s()}a.appendChild(i),f=document.createElement("p"),a.appendChild(f),o.appendChild(a),document.getElementById("snake-reset-btn").addEventListener("click",(function(){d.reset()}));var v=document.getElementById("snake-env-controls").getElementsByTagName("span"),u=[1,20,60],b=function(){var e=r;v[r].addEventListener("click",(function(){for(var t=0;t<3;t++)v[t].className="";v[e].className="selected",d.setFPS(u[e])}))};for(r=0;r<3;r++)b();m(0)}(6,6,[{name:"Naive searcher",description:"If there is food within ".concat(6," steps, goes for it with the shortest possible path. (uses breadth-first search)\n      <br><br>\n      Notice for example that it tends to die in \"dead ends\", i.e. it chased the food in such a way that it then can't avoid hitting its own body.\n      Had it been smarter, it would've realised that it has to wait a bit for its body to move out of the way"),processObservation:function(e,t){for(var n=e.env.getSuccessors(),i=[],s=0;s<4;s++)n[s]&&i.push({state:n[s],move:s});for(var o=0,r=0,h=-1;o<6&&-1==h&&r<i.length;){for(var d=i.length,c=r;c<d;c++)if(1==i[c].state.reward){h=i[c].move;break}if(-1!=h)break;var l=!1;for(c=r;c<d;c++)if(-1!=i[c].state.reward){for(var p=i[c].state.env.getSuccessors(),f=0;f<4;f++)if(p[f]){if(1==p[f].reward){l=!0,h=i[c].move;break}i.push({state:p[f],move:i[c].move})}if(l)break}r=d,o++}if(-1==h){var m=[];for(c=0;c<4;c++)n[c]&&n[c].reward>-1&&m.push(c);h=m[Object(a.b)(0,m.length)]}e.sendAction(h)}},{name:"Cautious searcher",description:"Using BFS, looks for food reachable within ".concat(9," steps.\n      It's cautious because it then validates these food paths by looking forward ").concat(9," more steps (branchings of the state space).\n      If there are any reachable states left, goes for the food. Otherwise, looks for a different path.\n      <br>\n      If no reachable and safe food is found, does the action that results in the most flexible search space; meaning how many reachable states in depth ").concat(9,". This for example helps avoid dead ends\n      <br><br>\n      These considerations are done by first constructing a search tree of possible states of height ").concat(9,", then searching, updating and pruning this tree as necessary.\n      In short, you don't repeatedly generate the same possible states. \n      "),processObservation:function(e,t){if(1==t.reward&&(u=[],v=null),u.length>0)e.sendAction(u.pop());else{t.reset&&(v=null),null==v&&b(v={env:e.env,safeFood:!1,parent:null,action:null},9);for(var n=[v],a=0;a<9;a++){for(var i=!1,s=0;s<n.length;s++)if(n[s].safeFood){if(y(n[s],9)){for(var o=n[s];o.parent;)u.push(o.action),o=o.parent;i=!0;break}n[s].safeFood=!1}if(i)break;var r=[];for(s=0;s<n.length;s++)for(var h=0;h<4;h++)n[s][h]&&r.push(n[s][h]);n=r}if(0==u.length){var d=0,c=0;for(s=0;s<4;s++)if(v[s]){var l=g(v[s]);l>=c&&(d=s,c=l)}u=[d]}for(s=u.length-1;s>=0;s--){if(!v[u[s]])return v=null,void e.sendAction(0);delete(v=v[u[s]]).parent}_(v,9),e.sendAction(u.pop())}}},{name:"Slow-optimal",description:'Always manages to win by following a pre-set path.\n    <br><br>\n    As the name suggests, the downside is that this is extremely slow. There are workarounds and shortcuts you can use to improve this algorithm, and I might come back to do that.\n    <br><br>\n    Another interesting thing to note is that approaches like this rely on at least one side (width or height) of the environment to be even.\n    You can read more about it in <a href="https://gamedev.stackexchange.com/questions/133460/how-to-find-a-safe-path-for-an-ai-snake" target="_blank">this StackOverflow question</a>.\n    (hint: it has to do with Hamiltonian cycles)',processObservation:function(e,t){t.reset&&(w=0),0==w?e.env.head_x>0?e.sendAction(3):e.env.head_y>0?e.sendAction(0):(w++,e.sendAction(1)):1==w?1==e.env.head_x&&e.env.head_y%2&&e.env.head_y+1<e.env.map_height||e.env.head_x+1==e.env.map_width&&e.env.head_y%2==0?e.sendAction(2):e.env.head_y%2==0?e.sendAction(1):(e.sendAction(3),1==e.env.head_x&&e.env.head_y+1>=e.env.map_height&&w++):2==w&&(e.env.head_x>0?e.sendAction(3):e.sendAction(0),1==e.env.head_y&&(w=1))}}])},38:function(e){e.exports=JSON.parse('[{"filename":"index","name":"AI demos"},{"filename":"mnist","name":"Handwritten digits","category":"Image Classification","notebook":"https://github.com/tadeaspaule/ai-demos-notebooks/blob/master/cnn-handwritten-digit-classifier.ipynb","dataset":"https://www.tensorflow.org/api_docs/python/tf/keras/datasets/mnist"},{"filename":"catgan","name":"Cat faces","category":"Image Generation","notebook":"https://github.com/tadeaspaule/ai-demos-notebooks/blob/master/GAN-cat-faces.ipynb","dataset":"https://www.kaggle.com/spandan2/cats-faces-64x64-for-generative-models"},{"filename":"unintelligent-snakes","name":"(un)intelligent snakes","category":"\\"AI\\""}]')},46:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d}));var a=n(38);function i(e){return"/ai-demos".concat(e)}function s(){var e=window.location.href.split("/"),t=e[e.length-1];0==(t=t.replace(".html","")).length&&(t="index");var n=a.find((e=>e.filename==t)),s=document.createElement("div");s.className="nav";var d=document.createElement("h4"),c=document.createElement("a");c.textContent=a[0].name,"index"==t&&(c.className="current"),c.href=i("/"),d.appendChild(c),s.appendChild(d);var l={};a.forEach((e=>{e.category&&(l[e.category]?l[e.category].push(e):l[e.category]=[e])}));var p=Object.keys(l);p.sort(),p.forEach((e=>{var n=document.createElement("div");n.className="nav-cat";var a=document.createElement("h4");a.textContent=e,n.appendChild(a),l[e].forEach((e=>{var a=document.createElement("a");a.href=i("/".concat(e.filename,".html")),t==e.filename&&(a.className="current"),a.textContent=e.name,n.appendChild(a)})),s.appendChild(n)})),document.body.appendChild(s);var f=document.createElement("div");f.className="nav-status fr fac";var m=h("list","btn");f.appendChild(m);var v=document.createElement("div");v.className="click-catcher",document.body.appendChild(v),m.addEventListener("click",(function(){s.classList.add("shown"),v.classList.add("shown"),v.style.zIndex=1})),v.addEventListener("click",(function(){s.classList.remove("shown"),v.classList.remove("shown"),setTimeout((()=>{v.style.zIndex=-1}),400)}));var u=document.createElement("h2");if(u.textContent=n.name,f.appendChild(u),"index"!=t&&f.appendChild(o("https://github.com/tadeaspaule/ai-demos/tree/master/src/".concat(n.filename),"demo code")),n.notebook&&f.appendChild(o(n.notebook,"ai code")),n.dataset){var b=h("photo_library");b.style.fontSize="20px",f.appendChild(r(n.dataset,"dataset",b))}document.body.insertBefore(f,document.body.children[0])}function o(e,t){var n=document.createElement("img");return n.src="assets/githubicon.png",n.height=16,r(e,t,n)}function r(e,t,n){var a=document.createElement("div");a.className="fr fac picturelink",a.appendChild(n);var i=document.createElement("a");return i.href=e,i.textContent=t,i.target="_blank",a.appendChild(i),a}function h(e,t){t||(t="");var n=document.createElement("i");return n.textContent=e,n.className="material-icons ".concat(t),n}function d(e,t){return Math.floor(e+Math.random()*(t-e))}}});